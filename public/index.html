<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Speech-to-Paste</title>
  <link rel="stylesheet" href="/style.css">
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>Speech-to-Paste Settings & Transcriptions</h1>
      <div class="status">
        <span>Status:</span>
        <div class="status-indicator status-idle" id="statusIndicator"></div>
        <span id="statusText">Idle</span>
      </div>
    </div>

    <div class="controls">
      <button id="toggleHotkeys">Disable Hotkeys</button>
      <button id="clearHistory">Clear History</button>
      <button id="exportConfig">Export Config</button>
      <button id="importConfig">Import Config</button>
      <input type="file" id="importFileInput" accept=".json" style="display: none;">
      <button onclick="location.reload()">Refresh</button>
    </div>

    <div class="config-section">
      <h2>Configuration</h2>
      
      <div class="config-item">
        <label>Whisper Mode:</label>
        <div class="radio-group">
          <label class="radio-label">
            <input type="radio" name="whisperMode" value="api" id="modeApi">
            <span>OpenAI API (Cloud)</span>
          </label>
          <label class="radio-label">
            <input type="radio" name="whisperMode" value="local" id="modeLocal">
            <span>Local (Offline)</span>
          </label>
        </div>
        <small>Choose between cloud API (requires key & internet) or local processing (no costs)</small>
      </div>

      <div class="config-item" id="apiKeySection">
        <label for="apiKey">OpenAI API Key:</label>
        <div class="api-key-input">
          <input type="password" id="apiKey" placeholder="sk-...">
          <button id="saveApiKey">Save</button>
          <span id="apiKeyStatus"></span>
        </div>
        <small>Get your API key from <a href="https://platform.openai.com/api-keys" target="_blank">OpenAI</a></small>
      </div>

      <div class="config-item" id="modelSection" style="display: none;">
        <div id="localWarning" class="warning-box" style="display: none;">
          <strong>âš  Warning:</strong>
          <p class="warning-message">Local Whisper requires native compilation which is not yet set up. Please see README for setup instructions or use API mode.</p>
        </div>
        
        <label for="whisperModel">Local Model Size:</label>
        <div class="select-group">
          <select id="whisperModel">
            <option value="tiny">Tiny (~75MB, fastest)</option>
            <option value="base">Base (~140MB, balanced)</option>
            <option value="small">Small (~460MB, accurate)</option>
            <option value="medium">Medium (~1.5GB, very accurate)</option>
            <option value="large">Large (~3GB, most accurate)</option>
          </select>
          <button id="saveModel">Save</button>
        </div>
        <small>Larger models are more accurate but slower. Model will download on first use.</small>
      </div>

      <div class="config-item">
        <label class="checkbox-label">
          <input type="checkbox" id="audioFeedbackEnabled">
          <span>Enable Audio Feedback</span>
        </label>
        <small>Play sounds when recording starts and stops</small>
      </div>

      <div class="config-item">
        <label class="checkbox-label">
          <input type="checkbox" id="autoPasteEnabled">
          <span>Auto-Paste Transcribed Text</span>
        </label>
        <small>Automatically paste text into active window. When disabled, text is copied to clipboard with a notification.</small>
      </div>

      <div class="config-item">
        <label for="audioDevice">Audio Input Device:</label>
        <div class="select-group">
          <select id="audioDevice">
            <option value="-1">Default Device</option>
          </select>
          <button id="saveDevice">Save</button>
        </div>
        <small>Select which microphone to use for recording</small>
      </div>

      <div class="config-item">
        <label for="historyLimit">Transcription History Limit:</label>
        <div class="select-group">
          <input type="number" id="historyLimit" min="1" max="1000" value="50" style="width: 80px;">
          <button id="saveHistoryLimit">Save</button>
        </div>
        <small>Maximum number of transcriptions to keep (1-1000). Older entries are automatically removed.</small>
      </div>

      <div class="config-item">
        <label for="whisperLanguage">Transcription Language:</label>
        <div class="select-group">
          <select id="whisperLanguage">
            <option value="">Auto-detect</option>
            <option value="en">English</option>
            <option value="es">Spanish</option>
            <option value="fr">French</option>
            <option value="de">German</option>
            <option value="it">Italian</option>
            <option value="pt">Portuguese</option>
            <option value="nl">Dutch</option>
            <option value="pl">Polish</option>
            <option value="ru">Russian</option>
            <option value="zh">Chinese</option>
            <option value="ja">Japanese</option>
            <option value="ko">Korean</option>
            <option value="ar">Arabic</option>
            <option value="hi">Hindi</option>
          </select>
          <button id="saveLanguage">Save</button>
        </div>
        <small>Specify the language for better accuracy, or leave as auto-detect</small>
      </div>

      <div class="config-item">
        <label for="whisperTemperature">Sampling Temperature (0-1):</label>
        <div class="select-group">
          <input type="number" id="whisperTemperature" min="0" max="1" step="0.1" value="0" style="width: 80px;">
          <button id="saveTemperature">Save</button>
        </div>
        <small>Controls randomness: 0 = most consistent, 1 = most creative. Default: 0 (recommended for accuracy)</small>
      </div>

      <div class="config-item">
        <label for="whisperPrompt">Initial Prompt:</label>
        <div class="textarea-group">
          <textarea id="whisperPrompt" rows="3" placeholder="Optional prompt to guide transcription..."></textarea>
          <button id="savePrompt">Save</button>
        </div>
        <small>Optional text to guide the transcription style, include specific vocabulary, or fix recurring errors. Example: "This transcript contains technical terms like API, TypeScript, and Node.js."</small>
      </div>

      <div class="config-item">
        <label for="webServerPort">Web Server Port:</label>
        <div class="select-group">
          <input type="number" id="webServerPort" min="1024" max="65535" value="5933" style="width: 100px;">
          <button id="savePort">Save</button>
        </div>
        <small>Port for the web interface (1024-65535). Requires application restart to take effect. Default: 5933</small>
      </div>

      <div class="config-item">
        <label class="checkbox-label">
          <input type="checkbox" id="minimizeOnStartup">
          <span>Minimize to Tray on Startup</span>
        </label>
        <small>Start minimized without showing the console window (Windows only). Requires application restart to take effect.</small>
      </div>

      <div class="config-item">
        <label>Push-to-Talk Hotkey:</label>
        <div class="hotkey-capture">
          <input type="text" id="pushToTalkDisplay" readonly placeholder="Current hotkey...">
          <input type="number" id="pushToTalkKeyCode" placeholder="Key code" style="width: 100px;" min="0">
          <button id="savePushToTalk">Save</button>
        </div>
        <small>Enter the key code manually (e.g., 3653 for Pause/Break, 112-123 for F1-F12). Requires restart. <a href="#" id="showKeyCodeHelp">Show common key codes</a></small>
      </div>

      <div class="config-item">
        <label>Toggle Listen Hotkey:</label>
        <div class="hotkey-capture">
          <input type="text" id="toggleListenDisplay" readonly placeholder="Current hotkey...">
          <input type="number" id="toggleListenKeyCode" placeholder="Key code" style="width: 100px;" min="0">
          <button id="saveToggleListen">Save</button>
        </div>
        <small>Enter the key code and check modifiers. Requires restart. <a href="#" id="showKeyCodeHelp2">Show common key codes</a></small>
        <div class="modifier-checks" style="margin-top: 5px;">
          <label class="checkbox-label" style="display: inline-flex; margin-right: 15px;">
            <input type="checkbox" id="toggleShift">
            <span>Shift</span>
          </label>
          <label class="checkbox-label" style="display: inline-flex; margin-right: 15px;">
            <input type="checkbox" id="toggleCtrl">
            <span>Ctrl</span>
          </label>
          <label class="checkbox-label" style="display: inline-flex;">
            <input type="checkbox" id="toggleAlt">
            <span>Alt</span>
          </label>
        </div>
      </div>

      <div id="keyCodeHelp" class="info-box" style="display: none; margin-top: 10px;">
        <strong>Common Key Codes (uiohook-napi):</strong>
        <ul style="margin: 10px 0; padding-left: 20px; columns: 2;">
          <li><strong>3653</strong> - Pause/Break</li>
          <li><strong>112-123</strong> - F1 to F12</li>
          <li><strong>65-90</strong> - A to Z</li>
          <li><strong>48-57</strong> - 0 to 9</li>
          <li><strong>32</strong> - Space</li>
          <li><strong>13</strong> - Enter</li>
          <li><strong>27</strong> - Escape</li>
          <li><strong>8</strong> - Backspace</li>
          <li><strong>9</strong> - Tab</li>
        </ul>
        <small>Note: Use the application's console output to see the actual key code when you press a key.</small>
      </div>
    </div>

    <div class="transcriptions" id="transcriptions">
      <div class="empty-state">No transcriptions yet</div>
    </div>
  </div>

  <script src="/app.js"></script>
</body>
</html>
